apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: stormworkerpools.storm.apache.org
  annotations:
    controller-gen.kubebuilder.io/version: v0.13.0
    "helm.sh/resource-policy": keep
spec:
  group: storm.apache.org
  names:
    kind: StormWorkerPool
    listKind: StormWorkerPoolList
    plural: stormworkerpools
    singular: stormworkerpool
    shortNames:
    - swp
  scope: Namespaced
  versions:
  - name: v1beta1
    served: true
    storage: true
    subresources:
      status: {}
      scale:
        specReplicasPath: .spec.replicas
        statusReplicasPath: .status.replicas
    schema:
      openAPIV3Schema:
        description: StormWorkerPool is the Schema for the stormworkerpools API
        type: object
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation of an object.'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this object represents.'
            type: string
          metadata:
            type: object
          spec:
            description: StormWorkerPoolSpec defines the desired state of StormWorkerPool
            type: object
            required:
            - topologyRef
            properties:
              topologyRef:
                description: Reference to the StormTopology resource
                type: string
              clusterRef:
                description: Reference to the StormCluster resource (inherited from topology)
                type: string
              replicas:
                description: Number of worker replicas
                type: integer
                minimum: 1
                default: 1
              image:
                description: Override image configuration for workers
                type: object
                properties:
                  registry:
                    description: Docker registry for the worker image
                    type: string
                  repository:
                    description: Docker repository for the worker image
                    type: string
                  tag:
                    description: Worker image tag
                    type: string
                  pullPolicy:
                    description: Image pull policy
                    type: string
                    enum:
                    - Always
                    - IfNotPresent
                    - Never
                  pullSecrets:
                    description: Image pull secrets
                    type: array
                    items:
                      type: string
              template:
                description: Pod template for workers
                type: object
                properties:
                  metadata:
                    description: Metadata for worker pods
                    type: object
                    properties:
                      labels:
                        description: Labels for worker pods
                        type: object
                        additionalProperties:
                          type: string
                      annotations:
                        description: Annotations for worker pods
                        type: object
                        additionalProperties:
                          type: string
                  spec:
                    description: Pod spec for workers
                    type: object
                    properties:
                      containers:
                        description: Container overrides
                        type: array
                        items:
                          type: object
                          properties:
                            name:
                              description: Container name
                              type: string
                            resources:
                              description: Resource requirements
                              type: object
                              properties:
                                requests:
                                  type: object
                                  additionalProperties:
                                    anyOf:
                                    - type: integer
                                    - type: string
                                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                                    x-kubernetes-int-or-string: true
                                limits:
                                  type: object
                                  additionalProperties:
                                    anyOf:
                                    - type: integer
                                    - type: string
                                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                                    x-kubernetes-int-or-string: true
                            env:
                              description: Environment variables
                              type: array
                              items:
                                type: object
                                properties:
                                  name:
                                    type: string
                                  value:
                                    type: string
                                  valueFrom:
                                    type: object
                            volumeMounts:
                              description: Volume mounts
                              type: array
                              items:
                                type: object
                      volumes:
                        description: Volumes for worker pods
                        type: array
                        items:
                          type: object
                      affinity:
                        description: Affinity rules for worker pods
                        type: object
                      tolerations:
                        description: Tolerations for worker pods
                        type: array
                        items:
                          type: object
                      nodeSelector:
                        description: Node selector for worker pods
                        type: object
                        additionalProperties:
                          type: string
                      priorityClassName:
                        description: Priority class name for worker pods
                        type: string
                      serviceAccountName:
                        description: Service account name for worker pods
                        type: string
                      securityContext:
                        description: Security context for worker pods
                        type: object
                      hostNetwork:
                        description: Use host network
                        type: boolean
                        default: false
                      hostPID:
                        description: Use host PID namespace
                        type: boolean
                        default: false
                      hostIPC:
                        description: Use host IPC namespace
                        type: boolean
                        default: false
                      dnsPolicy:
                        description: DNS policy for worker pods
                        type: string
                        enum:
                        - ClusterFirst
                        - ClusterFirstWithHostNet
                        - Default
                        - None
                      dnsConfig:
                        description: DNS configuration for worker pods
                        type: object
                      terminationGracePeriodSeconds:
                        description: Termination grace period in seconds
                        type: integer
                        minimum: 0
              workerConfig:
                description: Worker-specific Storm configuration
                type: object
                additionalProperties: true
              jvmOpts:
                description: JVM options for workers
                type: array
                items:
                  type: string
              ports:
                description: Port configuration for workers
                type: object
                properties:
                  start:
                    description: Starting port number
                    type: integer
                    minimum: 1024
                    maximum: 65535
                    default: 6700
                  count:
                    description: Number of ports to allocate
                    type: integer
                    minimum: 1
                    default: 4
          status:
            description: StormWorkerPoolStatus defines the observed state of StormWorkerPool
            type: object
            properties:
              replicas:
                description: Current number of replicas
                type: integer
              readyReplicas:
                description: Number of ready replicas
                type: integer
              availableReplicas:
                description: Number of available replicas
                type: integer
              unavailableReplicas:
                description: Number of unavailable replicas
                type: integer
              updatedReplicas:
                description: Number of updated replicas
                type: integer
              deploymentName:
                description: Name of the generated deployment
                type: string
              hpaName:
                description: Name of the generated HPA
                type: string
              phase:
                description: Current phase of the worker pool
                type: string
                enum:
                - Pending
                - Creating
                - Running
                - Updating
                - Failed
                - Terminating
              message:
                description: Human-readable message about current status
                type: string
              lastUpdateTime:
                description: Last time the status was updated
                type: string
                format: date-time
              conditions:
                description: Current service state of worker pool
                type: array
                items:
                  type: object
                  properties:
                    type:
                      description: Type of condition
                      type: string
                    status:
                      description: Status of the condition, one of True, False, Unknown
                      type: string
                    lastTransitionTime:
                      description: Last time the condition transitioned from one status to another
                      type: string
                      format: date-time
                    reason:
                      description: The reason for the condition's last transition
                      type: string
                    message:
                      description: A human readable message indicating details about the transition
                      type: string
                  required:
                  - type
                  - status
              observedGeneration:
                description: ObservedGeneration reflects the generation of the most recently observed StormWorkerPool
                type: integer
    additionalPrinterColumns:
    - name: Topology
      type: string
      jsonPath: .spec.topologyRef
    - name: Replicas
      type: integer
      jsonPath: .spec.replicas
    - name: Ready
      type: integer
      jsonPath: .status.readyReplicas
    - name: Phase
      type: string
      jsonPath: .status.phase
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp